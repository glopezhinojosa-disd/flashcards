<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>English ‚Ä¢ Vocabulary Set 1 (Wikimedia images)</title>
  <style>
    :root { --bg:#0f172a; --card:#111827; --card2:#0b1222; --text:#e5e7eb; --accent:#60a5fa; --muted:#9ca3af; --green:#86efac; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif;background:linear-gradient(160deg,#0b1020,#0f172a 40%,#0b1020 100%);color:var(--text);min-height:100vh;display:grid;grid-template-rows:auto auto 1fr auto}
    header,footer{padding:14px 18px;display:flex;align-items:center;justify-content:space-between;gap:10px}
    header h1{font-size:18px;margin:0;color:var(--accent)}
    .sub{font-size:12px;color:var(--muted)}
    .toolbar{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    a.btn{color:var(--text);text-decoration:none;background:#1f2937;border:1px solid rgba(255,255,255,.08);padding:8px 12px;border-radius:10px;font-size:14px}
    a.btn:hover{border-color:rgba(255,255,255,.18)}
    .wrap{display:grid;place-items:center;padding:18px}
    .card{width:min(980px,96vw);min-height:360px;perspective:1200px}
    .inner{position:relative;width:100%;min-height:360px;transition:transform .6s;transform-style:preserve-3d}
    .flipped .inner{transform:rotateY(180deg)}
    .face{position:absolute;inset:0;display:grid;grid-template-columns:1fr 1.2fr;gap:18px;align-items:center;background:radial-gradient(1200px 600px at 20% 0%,var(--card),var(--card2));border:1px solid rgba(255,255,255,.06);border-radius:18px;box-shadow:0 10px 40px rgba(0,0,0,.45),inset 0 1px 0 rgba(255,255,255,.04);backface-visibility:hidden;padding: clamp(16px, 2.4vw, 28px)}
    .media{display:grid;place-items:center}
    .media img{max-width:100%;max-height:270px;border-radius:12px;border:1px solid rgba(255,255,255,.08);object-fit:cover}
    .content{text-align:center;padding:0 10px}
    .lead{font-size:13px;color:var(--muted);margin:0 0 6px}
    h2{font-size:clamp(28px,4.6vw,44px);margin:6px 0 10px}
    .pron{font-size:clamp(18px,3vw,22px);color:var(--green);margin:4px 0 10px}
    .meaning{font-size:clamp(18px,2.6vw,22px);margin:6px 0}
    .back{transform:rotateY(180deg)}
    .controls{margin:14px 0 0;display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:center}
    button{background:#1f2937;color:var(--text);border:1px solid rgba(255,255,255,.08);padding:10px 14px;border-radius:12px;font-size:15px;cursor:pointer;transition:transform .06s ease, background .2s, border-color .2s}
    button:hover{background:#243041;border-color:rgba(255,255,255,.14)}
    button:active{transform:translateY(1px)}
    .pill{font-size:13px;color:var(--muted);background:rgba(255,255,255,.05);padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.06)}
    .kbd{font-family:ui-monospace,Consolas,monospace;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.12);padding:2px 6px;border-radius:6px;color:#cbd5e1}
    footer{justify-content:center;font-size:12px;color:var(--muted)}
    figcaption{font-size:12px;color:var(--muted);margin-top:6px}
    .hidden{display:none}
  </style>
</head>
<body>
  <header>
    <div class="toolbar">
      <a class="btn" href="english.html" id="backEnglish">‚Üê English Menu</a>
      <a class="btn" href="index.html">üè† Home</a>
      <h1>English ‚Ä¢ Vocabulary Set 1 (Wikimedia images)</h1>
      <span class="sub">Click the card to flip</span>
    </div>
    <div class="toolbar">
      <span class="pill"><span id="counter">Card 1 of 130</span></span>
    </div>
  </header>

  <section class="wrap">
    <div id="card" class="card">
      <div class="inner">
        <!-- FRONT = word only (no image) -->
        <section class="face front" id="front">
          <div class="content" style="grid-column:1 / -1">
            <p class="lead">Front</p>
            <h2 id="frontWord">Word</h2>
          </div>
        </section>

        <!-- BACK = meaning + (optional) image -->
        <section class="face back" id="back">
          <div class="media hidden" id="mediaBack">
            <img id="imgBack" alt=""/>
          </div>
          <div class="content">
            <p class="lead">Back</p>
            <div class="pron" id="pron">(pronunciaci√≥n)</div>
            <div class="meaning" id="meaningEs">Significado en espa√±ol</div>
            <figcaption id="imgCaption" aria-live="polite"></figcaption>
          </div>
        </section>
      </div>
    </div>

    <div class="controls">
      <button id="prevBtn" title="Previous (‚Üê)">‚üµ Prev</button>
      <button id="flipBtn" title="Flip (Space)">Flip</button>
      <button id="nextBtn" title="Next (‚Üí)">Next ‚ü∂</button>
      <button id="shuffleBtn" title="Shuffle cards">Shuffle</button>
      <span class="pill">Keys: <span class="kbd">‚Üê</span> <span class="kbd">Space</span> <span class="kbd">‚Üí</span></span>
    </div>
  </section>

  <footer>Images fetched from Wikimedia Commons via API ‚Ä¢ Only shown on the back</footer>

  <script>
    const PLACEHOLDER = "data:image/svg+xml;charset=utf-8," + encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="800" height="500"><rect width="100%" height="100%" fill="#111827"/></svg>');

    const cards = [
      /* ---------------- SAFE VERBS (40) ---------------- */
      {type:"verb", front:"Run", pron:"(r√°n)", es:"correr", wikimediaQuery:"child running park"},
      {type:"verb", front:"Eat", pron:"(√≠t)", es:"comer", wikimediaQuery:"person eating food"},
      {type:"verb", front:"Go", pron:"(g√≥u)", es:"ir", wikimediaQuery:"people walking street"},
      {type:"verb", front:"See", pron:"(s√≠)", es:"ver", wikimediaQuery:"person looking binoculars"},
      {type:"verb", front:"Speak", pron:"(sp√≠k)", es:"hablar", wikimediaQuery:"teacher speaking classroom"},
      {type:"verb", front:"Read", pron:"(r√≠d)", es:"leer", wikimediaQuery:"child reading book"},
      {type:"verb", front:"Write", pron:"(r√°it)", es:"escribir", wikimediaQuery:"student writing notebook"},
      {type:"verb", front:"Play", pron:"(pl√©i)", es:"jugar", wikimediaQuery:"children playing soccer"},
      {type:"verb", front:"Have", pron:"(j√°v)", es:"tener", wikimediaQuery:"family having picnic"},
      {type:"verb", front:"Do", pron:"(d√∫)", es:"hacer", wikimediaQuery:"student doing homework"},
      {type:"verb", front:"Want", pron:"(u√≥nt)", es:"querer", wikimediaQuery:"child wanting toy"},
      {type:"verb", front:"Need", pron:"(n√≠d)", es:"necesitar", wikimediaQuery:"person needing help"},
      {type:"verb", front:"Like", pron:"(l√°ik)", es:"gustar", wikimediaQuery:"person liking food happy"},
      {type:"verb", front:"Make", pron:"(m√©ik)", es:"hacer/fabricar", wikimediaQuery:"child making craft"},
      {type:"verb", front:"Take", pron:"(t√©ik)", es:"tomar/ llevar", wikimediaQuery:"student taking book"},
      {type:"verb", front:"Give", pron:"(gu√≠v)", es:"dar", wikimediaQuery:"teacher giving paper"},
      {type:"verb", front:"Open", pron:"(√≥upen)", es:"abrir", wikimediaQuery:"hand opening door"},
      {type:"verb", front:"Close", pron:"(kl√≥us)", es:"cerrar", wikimediaQuery:"hand closing book"},
      {type:"verb", front:"Work", pron:"(u√©rk)", es:"trabajar", wikimediaQuery:"people working office"},
      {type:"verb", front:"Study", pron:"(st√°di)", es:"estudiar", wikimediaQuery:"student studying desk"},
      {type:"verb", front:"Yell", pron:"(yel)", es:"gritar", wikimediaQuery:"coach yelling sports"},
      {type:"verb", front:"Gag", pron:"(gag)", es:"dar arcadas / asquearse", wikimediaQuery:"cartoon gag reflex safe"},
      {type:"verb", front:"Gallop", pron:"(g√°lop)", es:"galopar", wikimediaQuery:"horse galloping field"},
      {type:"verb", front:"Slide", pron:"(esl√°id)", es:"deslizar(se)", wikimediaQuery:"children sliding playground"},
      {type:"verb", front:"Stumble", pron:"(st√≥m-bol)", es:"tropezar", wikimediaQuery:"person stumbling sidewalk"},
      {type:"verb", front:"Whisper", pron:"(w√≠sper)", es:"susurrar", wikimediaQuery:"friends whispering safe"},
      {type:"verb", front:"Shove", pron:"(shov)", es:"empujar bruscamente", wikimediaQuery:"students shove game playful"},
      {type:"verb", front:"Scrub", pron:"(escr√≥b)", es:"restregar / tallar", wikimediaQuery:"person scrubbing floor"},
      {type:"verb", front:"Stir", pron:"(st√©r)", es:"revolver (comida)", wikimediaQuery:"person stirring soup"},
      {type:"verb", front:"Peel", pron:"(p√≠l)", es:"pelar", wikimediaQuery:"hand peeling banana"},
      {type:"verb", front:"Fetch", pron:"(fech)", es:"ir por / traer", wikimediaQuery:"dog fetching ball"},
      {type:"verb", front:"Mend", pron:"(mend)", es:"remendar / arreglar", wikimediaQuery:"person mending clothes"},
      {type:"verb", front:"Stack", pron:"(st√°k)", es:"apilar", wikimediaQuery:"child stacking blocks"},
      {type:"verb", front:"Sweep", pron:"(su√≠p)", es:"barrer", wikimediaQuery:"person sweeping floor"},
      {type:"verb", front:"Kneel", pron:"(n√≠l)", es:"arrodillarse", wikimediaQuery:"child kneeling shoelace"},
      {type:"verb", front:"Stretch", pron:"(estr√©ch)", es:"estirarse", wikimediaQuery:"person stretching exercise"},
      {type:"verb", front:"Crawl", pron:"(kr√≥l)", es:"gatear / arrastrarse", wikimediaQuery:"baby crawling"},
      {type:"verb", front:"Blink", pron:"(bl√≠nk)", es:"parpadear", wikimediaQuery:"cartoon blinking eyes"},
      {type:"verb", front:"Shrug", pron:"(shrog)", es:"encogerse de hombros", wikimediaQuery:"cartoon shrug shoulders"},
      {type:"verb", front:"Sip", pron:"(sip)", es:"beber a sorbos", wikimediaQuery:"person sipping tea"},
    
      /* ---------------- SAFE NOUNS (60) ---------------- */
      {type:"noun", front:"Book", es:"libro", pron:"(b√∫k)", wikimediaQuery:"book cover"},
      {type:"noun", front:"Table", es:"mesa", pron:"(t√©ibol)", wikimediaQuery:"dining table"},
      {type:"noun", front:"House", es:"casa", pron:"(j√°us)", wikimediaQuery:"house building"},
      {type:"noun", front:"School", es:"escuela", pron:"(sk√∫l)", wikimediaQuery:"school classroom outside"},
      {type:"noun", front:"Friend", es:"amigo/amiga", pron:"(fr√©nd)", wikimediaQuery:"friends smiling"},
      {type:"noun", front:"Teacher", es:"maestro/a", pron:"(t√≠cher)", wikimediaQuery:"teacher in classroom"},
      {type:"noun", front:"Water", es:"agua", pron:"(u√≥ter)", wikimediaQuery:"glass of water"},
      {type:"noun", front:"Food", es:"comida", pron:"(f√∫d)", wikimediaQuery:"healthy food plate"},
      {type:"noun", front:"Car", es:"carro", pron:"(k√°r)", wikimediaQuery:"car vehicle"},
      {type:"noun", front:"Dog", es:"perro", pron:"(d√≥g)", wikimediaQuery:"dog pet"},
      {type:"noun", front:"Chair", es:"silla", pron:"(ch√©er)", wikimediaQuery:"chair furniture"},
      {type:"noun", front:"Bed", es:"cama", pron:"(b√©d)", wikimediaQuery:"bedroom bed"},
      {type:"noun", front:"Pen", es:"pluma", pron:"(p√©n)", wikimediaQuery:"pen ballpoint"},
      {type:"noun", front:"Phone", es:"tel√©fono", pron:"(f√≥n)", wikimediaQuery:"mobile phone"},
      {type:"noun", front:"Computer", es:"computadora", pron:"(kompi√∫ter)", wikimediaQuery:"laptop computer"},
      {type:"noun", front:"City", es:"ciudad", pron:"(s√≠ti)", wikimediaQuery:"city skyline"},
      {type:"noun", front:"Street", es:"calle", pron:"(str√≠t)", wikimediaQuery:"street road"},
      {type:"noun", front:"Window", es:"ventana", pron:"(u√≠ndou)", wikimediaQuery:"house window"},
      {type:"noun", front:"Door", es:"puerta", pron:"(d√≥r)", wikimediaQuery:"wooden door"},
      {type:"noun", front:"Family", es:"familia", pron:"(f√°mili)", wikimediaQuery:"happy family"},
      {type:"noun", front:"Building", es:"edificio", pron:"(b√≠lding)", wikimediaQuery:"tall building"},
      {type:"noun", front:"Church", es:"iglesia", pron:"(ch√©rch)", wikimediaQuery:"church building"},
      {type:"noun", front:"Aunt", es:"t√≠a", pron:"(ant)", wikimediaQuery:"aunt smiling woman"},
      {type:"noun", front:"Uncle", es:"t√≠o", pron:"(√≥ncol)", wikimediaQuery:"uncle family man"},
      {type:"noun", front:"Ladder", es:"escalera", pron:"(l√°d-er)", wikimediaQuery:"ladder tool"},
      {type:"noun", front:"Shovel", es:"pala", pron:"(sh√≥vol)", wikimediaQuery:"shovel gardening"},
      {type:"noun", front:"Bucket", es:"cubeta", pron:"(b√≥ket)", wikimediaQuery:"plastic bucket"},
      {type:"noun", front:"Bench", es:"banco", pron:"(bench)", wikimediaQuery:"park bench"},
      {type:"noun", front:"Sidewalk", es:"banqueta/acera", pron:"(s√°id-uok)", wikimediaQuery:"sidewalk pavement"},
      {type:"noun", front:"Alley", es:"callej√≥n", pron:"(√°li)", wikimediaQuery:"alley street"},
      {type:"noun", front:"Barn", es:"granero", pron:"(barn)", wikimediaQuery:"barn farm"},
      {type:"noun", front:"Bridge", es:"puente", pron:"(br√≠y)", wikimediaQuery:"bridge river"},
      {type:"noun", front:"Chimney", es:"chimenea", pron:"(ch√≠m-ni)", wikimediaQuery:"house chimney"},
      {type:"noun", front:"Pillow", es:"almohada", pron:"(p√≠lo)", wikimediaQuery:"bed pillow"},
      {type:"noun", front:"Blanket", es:"cobija/manta", pron:"(bl√°nket)", wikimediaQuery:"blanket bed"},
      {type:"noun", front:"Suitcase", es:"maleta", pron:"(s√∫t-keis)", wikimediaQuery:"suitcase luggage"},
      {type:"noun", front:"Mailbox", es:"buz√≥n", pron:"(m√©il-boks)", wikimediaQuery:"mailbox street"},
      {type:"noun", front:"Faucet", es:"grifo", pron:"(f√≥set)", wikimediaQuery:"kitchen faucet"},
      {type:"noun", front:"Helmet", es:"casco", pron:"(h√©lmet)", wikimediaQuery:"safety helmet"},
      {type:"noun", front:"Leash", es:"correa", pron:"(l√≠sh)", wikimediaQuery:"dog leash"},
      {type:"noun", front:"Evidence", es:"evidencia", pron:"(√©videns)", wikimediaQuery:"evidence law classroom"},
      {type:"noun", front:"Hypothesis", es:"hip√≥tesis", pron:"(jaip√≥thesis)", wikimediaQuery:"hypothesis diagram science"},
      {type:"noun", front:"Experiment", es:"experimento", pron:"(eksp√©riment)", wikimediaQuery:"school science experiment"},
      {type:"noun", front:"Sample", es:"muestra", pron:"(s√°mpl)", wikimediaQuery:"sample laboratory tube"},
      {type:"noun", front:"Disease", es:"enfermedad", pron:"(dis√≠z)", wikimediaQuery:"cartoon disease germ safe"},
      {type:"noun", front:"Fever", es:"fiebre", pron:"(f√≠ver)", wikimediaQuery:"thermometer fever"},
      {type:"noun", front:"Microscope", es:"microscopio", pron:"(m√°ikroskoup)", wikimediaQuery:"microscope"},
      {type:"noun", front:"Laboratory", es:"laboratorio", pron:"(lab√≥ratori)", wikimediaQuery:"science laboratory"},
      {type:"noun", front:"Vaccine", es:"vacuna", pron:"(vaks√≠n)", wikimediaQuery:"vaccine vial safe"},
      {type:"noun", front:"Symptom", es:"s√≠ntoma", pron:"(s√≠mtom)", wikimediaQuery:"doctor symptom cartoon safe"},
      {type:"noun", front:"Conclusion", es:"conclusi√≥n", pron:"(konkl√∫shon)", wikimediaQuery:"conclusion diagram"},
      {type:"noun", front:"Data", es:"datos", pron:"(d√©ita)", wikimediaQuery:"data spreadsheet chart"},
      {type:"noun", front:"Graph", es:"gr√°fica", pron:"(gr√°f)", wikimediaQuery:"bar graph"},
      {type:"noun", front:"Result", es:"resultado", pron:"(ris√≥lt)", wikimediaQuery:"result check mark"},
      {type:"noun", front:"Scientist", es:"cient√≠fico/a", pron:"(s√°ientist)", wikimediaQuery:"scientist lab coat"},
      {type:"noun", front:"Environment", es:"medio ambiente", pron:"(env√°ironment)", wikimediaQuery:"nature environment"},
      {type:"noun", front:"Ecosystem", es:"ecosistema", pron:"(√≠kosistem)", wikimediaQuery:"ecosystem diagram"},
      {type:"noun", front:"Community", es:"comunidad", pron:"(komy√∫niti)", wikimediaQuery:"community people"},
      {type:"noun", front:"Government", es:"gobierno", pron:"(g√≥verment)", wikimediaQuery:"government building"},
      {type:"noun", front:"Economy", es:"econom√≠a", pron:"(ek√≥nomi)", wikimediaQuery:"economy finance"},
    
      /* ---------------- PHRASES (10, no images) ---------------- */
      {type:"phrase", front:"According to the text", pron:"(ac√≥rding tu de t√©kst)", es:"Seg√∫n el texto"},
      {type:"phrase", front:"Based on the passage", pron:"(beist on de p√°sich)", es:"Basado en el pasaje"},
      {type:"phrase", front:"As a result", pron:"(√°s a ris√≥lt)", es:"Como resultado"},
      {type:"phrase", front:"On the other hand", pron:"(on di √≥der jand)", es:"Por otro lado"},
      {type:"phrase", front:"In contrast to", pron:"(in k√≥ntrast tu)", es:"En contraste con"},
      {type:"phrase", front:"For instance", pron:"(for √≠nstans)", es:"Por ejemplo"},
      {type:"phrase", front:"Draw a conclusion", pron:"(dr√≥ a konkl√∫shon)", es:"Sacar una conclusi√≥n"},
      {type:"phrase", front:"Support your answer", pron:"(sop√≥rt y√≥r √°nswer)", es:"Justifica tu respuesta"},
      {type:"phrase", front:"Cause and effect", pron:"(k√≥z and if√©kt)", es:"Causa y efecto"},
      {type:"phrase", front:"Main idea", pron:"(m√©in aid√≠a)", es:"Idea principal"}
    ];

    // Cache for Wikimedia results by query
    const wmCache = new Map();

async function fetchWikimediaThumb(query){
  const API = 'https://commons.wikimedia.org/w/api.php';
  const BAD = [
    'adult','nsfw','nude','nudity','sex','sexual','erotic','porn','fetish','kissing',
    'violence','blood','gore','weapon','gun','knife','alcohol','drugs','smoking'
  ];
  const GOOD_HINTS = ['icon','pictogram','clip art','clipart','svg','diagram','illustration'];
  const isBad = (s='') => BAD.some(w => s.toLowerCase().includes(w));
  const isGood = (s='') => GOOD_HINTS.some(w => s.toLowerCase().includes(w));

  async function searchOnce(q){
    const params1 = new URLSearchParams({
      action:'query', format:'json', origin:'*',
      list:'search', srsearch:q, srnamespace:'6', srlimit:'5'
    });
    const r1 = await fetch(API + '?' + params1.toString());
    if (!r1.ok) return null;
    const data1 = await r1.json();
    const hits = data1?.query?.search || [];
    if (!hits.length) return null;

    const titles = hits.map(h => h.title).join('|');
    const params2 = new URLSearchParams({
      action:'query', format:'json', origin:'*',
      titles, prop:'imageinfo|categories',
      iiprop:'url', iiurlwidth:'700', cllimit:'50'
    });
    const r2 = await fetch(API + '?' + params2.toString());
    if (!r2.ok) return null;
    const data2 = await r2.json();
    const pages = Object.values(data2.query.pages || {});
    const candidates = pages.filter(p => {
      const title = p.title || '';
      if (isBad(title)) return false;
      const cats = (p.categories || []).map(c => c.title || '');
      if (cats.some(isBad)) return false;
      return p.imageinfo && p.imageinfo[0];
    });
    if (!candidates.length) return null;

    let best = candidates.find(p => isGood(p.title) || (p.categories||[]).some(c => isGood(c.title)));
    if (!best) best = candidates[0];

    const info = best.imageinfo[0];
    return { url: info.thumburl || info.url || null, title: best.title || '' };
  }

  // Try safer searches first (declared ONCE)
  const try1 = await searchOnce(query + ' icon');
  if (try1) return try1;
  const try2 = await searchOnce(query + ' diagram');
  if (try2) return try2;
  const try3 = await searchOnce(query + ' photo');
  if (try3) return try3;

  return { url: null, title: null };
} // end fetchWikimediaThumb



    async function getImageForCard(c){
      // Prefer explicit query, otherwise try the word itself (except generic phrases)
      const query = c.wikimediaQuery || (c.type !== "phrase" ? (c.front + " photo") : null);
      if (!query) return { url: null, title: "" };
    
      const r = await fetchWikimediaThumb(query);
      if (r.url) return r;
      return { url: null, title: "" };
    }

    let order = [...cards.keys()];
    let idx = 0, flipped = false;

    const card = document.getElementById('card');
    const imgBack  = document.getElementById('imgBack');
    const mediaBack = document.getElementById('mediaBack');
    const frontWord = document.getElementById('frontWord');
    const pron = document.getElementById('pron');
    const meaningEs = document.getElementById('meaningEs');
    const counter = document.getElementById('counter');
    const caption = document.getElementById('imgCaption');

    async function render(){
      const c = cards[order[idx]];
      frontWord.textContent = c.front;
      pron.textContent = c.pron || "";
      meaningEs.textContent = c.es || "";
      counter.textContent = `Card ${idx+1} of ${order.length}`;

      // default: hide image box on back
      mediaBack.classList.add('hidden');
      imgBack.src = PLACEHOLDER;
      caption.textContent = '';

      const {url, title} = await getImageForCard(c);
      if (url){
        imgBack.src = url;
        mediaBack.classList.remove('hidden');
        caption.textContent = title ? ('Wikimedia: ' + title) : '';
      }
    }
    function flip(){ flipped=!flipped; card.classList.toggle('flipped', flipped); }
    function next(){ idx=(idx+1)%order.length; flipped=false; card.classList.remove('flipped'); render(); }
    function prev(){ idx=(idx-1+order.length)%order.length; flipped=false; card.classList.remove('flipped'); render(); }
    function shuffle(){ for(let i=order.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1)); [order[i],order[j]]=[order[j],order[i]];} idx=0; flipped=false; card.classList.remove('flipped'); render(); }

    document.getElementById('flipBtn').addEventListener('click', flip);
    document.getElementById('nextBtn').addEventListener('click', next);
    document.getElementById('prevBtn').addEventListener('click', prev);
    document.getElementById('shuffleBtn').addEventListener('click', shuffle);
    card.addEventListener('click', flip);
    document.addEventListener('keydown', (e)=>{ if(e.code==='Space'){e.preventDefault(); flip();} if(e.key==='ArrowRight') next(); if(e.key==='ArrowLeft') prev(); });

    // Smart back button fallback
    fetch('english.html', {method:'HEAD'}).then(r=>{ if(!r.ok) document.getElementById('backEnglish').href='index.html'; }).catch(()=>{ document.getElementById('backEnglish').href='index.html'; });

    render();
  </script>
</body>
</html>
